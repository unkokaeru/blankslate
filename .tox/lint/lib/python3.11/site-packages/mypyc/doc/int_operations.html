<!DOCTYPE html>

<html lang="en" data-content_root="../../../../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Native integer operations &#8212; blankslate  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/alabaster.css?v=12dfc556" />
    <script src="../../../../../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="native-integer-operations">
<span id="int-ops"></span><h1>Native integer operations<a class="headerlink" href="#native-integer-operations" title="Link to this heading">¶</a></h1>
<p>Mypyc supports these integer types:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> (arbitrary-precision integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64</span></code> (64-bit signed integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32</span></code> (32-bit signed integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16</span></code> (16-bit signed integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u8</span></code> (8-bit unsigned integer)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">i64</span></code>, <code class="docutils literal notranslate"><span class="pre">i32</span></code>, <code class="docutils literal notranslate"><span class="pre">i16</span></code> and <code class="docutils literal notranslate"><span class="pre">u8</span></code> are <em>native integer types</em> and
are available in the <code class="docutils literal notranslate"><span class="pre">mypy_extensions</span></code> module. <code class="docutils literal notranslate"><span class="pre">int</span></code> corresponds
to the Python <code class="docutils literal notranslate"><span class="pre">int</span></code> type, but uses a more efficient runtime
representation (tagged pointer). Native integer types are value types.</p>
<p>All integer types have optimized primitive operations, but the native
integer types are more efficient than <code class="docutils literal notranslate"><span class="pre">int</span></code>, since they don’t
require range or bounds checks.</p>
<p>Operations on integers that are listed here have fast, optimized
implementations. Other integer operations use generic implementations
that are generally slower. Some operations involving integers and other
types, such as list indexing, are documented elsewhere.</p>
<section id="construction">
<h2>Construction<a class="headerlink" href="#construction" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">int</span></code> type:</p>
<ul class="simple">
<li><p>Integer literal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">float)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">i64)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">i32)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">i16)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">u8)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">str)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">str,</span> <span class="pre">base:</span> <span class="pre">int)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int(x:</span> <span class="pre">int)</span></code> (no-op)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">i64</span></code> type:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">int)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">float)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">i64)</span></code> (no-op)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">i32)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">i16)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">u8)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">str)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i64(x:</span> <span class="pre">str,</span> <span class="pre">base:</span> <span class="pre">int)</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">i32</span></code> type:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">int)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">float)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">i64)</span></code> (truncate)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">i32)</span></code> (no-op)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">i16)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">u8)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">str)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i32(x:</span> <span class="pre">str,</span> <span class="pre">base:</span> <span class="pre">int)</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">i16</span></code> type:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">int)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">float)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">i64)</span></code> (truncate)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">i32)</span></code> (truncate)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">i16)</span></code> (no-op)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">u8)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">str)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i16(x:</span> <span class="pre">str,</span> <span class="pre">base:</span> <span class="pre">int)</span></code></p></li>
</ul>
<p>Conversions from <code class="docutils literal notranslate"><span class="pre">int</span></code> to a native integer type raise
<code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> if the value is too large or small. Conversions from
a wider native integer type to a narrower one truncate the value and never
fail. More generally, operations between native integer types don’t
check for overflow.</p>
</section>
<section id="implicit-conversions">
<h2>Implicit conversions<a class="headerlink" href="#implicit-conversions" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">int</span></code> values can be implicitly converted to a native integer type,
for convenience. This means that these are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mypy_extensions</span> <span class="kn">import</span> <span class="n">i64</span>

<span class="k">def</span> <span class="nf">implicit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Implicit conversion of 0 (int) to i64</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">i64</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">explicit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># Explicit conversion of 0 (int) to i64</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">i64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Similarly, a native integer value can be implicitly converted to an
arbitrary-precision integer. These two functions are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">implicit</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">i64</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Implicit conversion from i64 to int</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">explicit</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">i64</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="c1"># Explicit conversion from i64 to int</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Arithmetic (<code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, <code class="docutils literal notranslate"><span class="pre">//</span></code>, <code class="docutils literal notranslate"><span class="pre">/</span></code>, <code class="docutils literal notranslate"><span class="pre">%</span></code>)</p></li>
<li><p>Bitwise operations (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, <code class="docutils literal notranslate"><span class="pre">^</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">~</span></code>)</p></li>
<li><p>Comparisons (<code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, etc.)</p></li>
<li><p>Augmented assignment (<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+=</span> <span class="pre">y</span></code>, etc.)</p></li>
</ul>
<p>If one of the above native integer operations overflows or underflows
with signed operands, the behavior is undefined. Signed native integer
types should only be used if all possible values are small enough for
the type. For this reason, the arbitrary-precision <code class="docutils literal notranslate"><span class="pre">int</span></code> type is
recommended for signed values unless the performance of integer
operations is critical.</p>
<p>Operations on unsigned integers (<code class="docutils literal notranslate"><span class="pre">u8</span></code>) wrap around on overflow.</p>
<p>It’s a compile-time error to mix different native integer types in a
binary operation such as addition. An explicit conversion is required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mypy_extensions</span> <span class="kn">import</span> <span class="n">i64</span><span class="p">,</span> <span class="n">i32</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">i64</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">i32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>  <span class="c1"># Error (i64 + i32)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">i64</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># OK</span>
</pre></div>
</div>
<p>You can freely mix a native integer value and an arbitrary-precision
<code class="docutils literal notranslate"><span class="pre">int</span></code> value in an operation. The native integer type is “sticky”
and the <code class="docutils literal notranslate"><span class="pre">int</span></code> operand is coerced to the native integer type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">example</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">i64</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="c1"># Type of &quot;a&quot; is &quot;i64&quot;</span>
    <span class="o">...</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span>
    <span class="c1"># Similarly, type of &quot;b&quot; is &quot;i64&quot;</span>
</pre></div>
</div>
</section>
<section id="statements">
<h2>Statements<a class="headerlink" href="#statements" title="Link to this heading">¶</a></h2>
<p>For loop over a range is compiled efficiently, if the <code class="docutils literal notranslate"><span class="pre">range(...)</span></code> object
is constructed in the for statement (after <code class="docutils literal notranslate"><span class="pre">in</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">range(end)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">range(start,</span> <span class="pre">end)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">x</span> <span class="pre">in</span> <span class="pre">range(start,</span> <span class="pre">end,</span> <span class="pre">step)</span></code></p></li>
</ul>
<p>If one of the arguments to <code class="docutils literal notranslate"><span class="pre">range</span></code> in a for loop is a native integer
type, the type of the loop variable is inferred to have this native
integer type, instead of <code class="docutils literal notranslate"><span class="pre">int</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i64</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
    <span class="c1"># Type of &quot;x&quot; is &quot;i64&quot;</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../../../../index.html">blankslate</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, William Fayers.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../../../../../../_sources/.tox/lint/lib/python3.11/site-packages/mypyc/doc/int_operations.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>